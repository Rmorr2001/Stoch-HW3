================================================================================
STARTING L-SHAPED METHOD
================================================================================

ITERATION 1
--------------------------------------------------------------------------------
Step 1: Solving master problem

Master Problem Formulation (Iteration 1):
================================================================================
Minimize  100*x1 + 150*x2

Subject to:
  1*x1 + 1*x2 ≤ 120
  x1 ≥ 40
  x2 ≥ 20
================================================================================
Master problem solution:
  x = [40.000000, 20.000000]
  θ = -inf
  Master objective = 7000.000000

Step 3: Solving subproblems

Subproblem Formulation (Scenario 1, Probability = 0.4):
================================================================================
h vector:
  h = [0, 0, 500, 100]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -24*y1 + -28*y2

Subject to:
  6*y1 + 10*y2 ≤ 2400.0000  (= 0 - -60*40.0 - 0*20.0)
  8*y1 + 5*y2 ≤ 1600.0000  (= 0 - 0*40.0 - -80*20.0)
  0 ≤ y1 ≤ 500
  0 ≤ y2 ≤ 100

Solution:
  y1 = 137.5000
  y2 = 100.0000
  Objective value = -6100.0000

Dual values (π vector):
  π = [0.0, -3.0, 0, -13.0]

Cut component calculations:
  e = p * π^T * h = 0.4 * ((0.0) * (0) + (-3.0) * (0) + (0) * (500) + (-13.0) * (100)) = 0.4 * -1300.0000 = -520.0000
  Final e = -520.0000
  E = p * π^T * T = 0.4 * π^T * T = [0.0000, 96.0000]
  w = e - E*x = -520.0000 - E*[40.0, 20.0] = -2440.0000
================================================================================

Subproblem Formulation (Scenario 2, Probability = 0.6):
================================================================================
h vector:
  h = [0, 0, 300, 300]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -28*y1 + -32*y2

Subject to:
  6*y1 + 10*y2 ≤ 2400.0000  (= 0 - -60*40.0 - 0*20.0)
  8*y1 + 5*y2 ≤ 1600.0000  (= 0 - 0*40.0 - -80*20.0)
  0 ≤ y1 ≤ 300
  0 ≤ y2 ≤ 300

Solution:
  y1 = 80.0000
  y2 = 192.0000
  Objective value = -8384.0000

Dual values (π vector):
  π = [-2.32, -1.76, 0, 0]

Cut component calculations:
  e = p * π^T * h = 0.6 * ((-2.32) * (0) + (-1.76) * (0) + (0) * (300) + (0) * (300)) = 0.6 * 0.0000 = 0.0000
  Final e = 0.0000
  E = p * π^T * T = 0.6 * π^T * T = [83.5200, 84.4800]
  w = e - E*x = 0.0000 - E*[40.0, 20.0] = -5030.4000
================================================================================

Combined Results (Iteration 1):
================================================================================
Total objective value: -7470.4000
Total e: -520.0000
Total E: [83.5200, 180.4800]
Total w: -7470.4000
================================================================================

GAP NOT CLOSED: w - θ = inf
Adding cut: 83.5200*x1 + 180.4800*x2 + θ ≥ -520.0000
--------------------------------------------------------------------------------

ITERATION 2
--------------------------------------------------------------------------------
Step 1: Solving master problem

Master Problem Formulation (Iteration 2):
================================================================================
Minimize  100*x1 + 150*x2 + θ

Subject to:
  1*x1 + 1*x2 ≤ 120
  x1 ≥ 40
  x2 ≥ 20

Optimality cuts:
  83.5200*x1 + 180.4800*x2 + θ ≥ -520.0000
================================================================================
Master problem solution:
  x = [40.000000, 80.000000]
  θ = -18299.200000
  Master objective = -2299.200000

Step 3: Solving subproblems

Subproblem Formulation (Scenario 1, Probability = 0.4):
================================================================================
h vector:
  h = [0, 0, 500, 100]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -24*y1 + -28*y2

Subject to:
  6*y1 + 10*y2 ≤ 2400.0000  (= 0 - -60*40.0 - 0*80.0)
  8*y1 + 5*y2 ≤ 6400.0000  (= 0 - 0*40.0 - -80*80.0)
  0 ≤ y1 ≤ 500
  0 ≤ y2 ≤ 100

Solution:
  y1 = 400.0000
  y2 = 0.0000
  Objective value = -9600.0000

Dual values (π vector):
  π = [-4.0, 0.0, 0, 0]

Cut component calculations:
  e = p * π^T * h = 0.4 * ((-4.0) * (0) + (0.0) * (0) + (0) * (500) + (0) * (100)) = 0.4 * 0.0000 = 0.0000
  Final e = 0.0000
  E = p * π^T * T = 0.4 * π^T * T = [96.0000, 0.0000]
  w = e - E*x = 0.0000 - E*[40.0, 80.0] = -3840.0000
================================================================================

Subproblem Formulation (Scenario 2, Probability = 0.6):
================================================================================
h vector:
  h = [0, 0, 300, 300]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -28*y1 + -32*y2

Subject to:
  6*y1 + 10*y2 ≤ 2400.0000  (= 0 - -60*40.0 - 0*80.0)
  8*y1 + 5*y2 ≤ 6400.0000  (= 0 - 0*40.0 - -80*80.0)
  0 ≤ y1 ≤ 300
  0 ≤ y2 ≤ 300

Solution:
  y1 = 300.0000
  y2 = 60.0000
  Objective value = -10320.0000

Dual values (π vector):
  π = [-3.2, 0.0, -8.8, 0]

Cut component calculations:
  e = p * π^T * h = 0.6 * ((-3.2) * (0) + (0.0) * (0) + (-8.8) * (300) + (0) * (300)) = 0.6 * -2640.0000 = -1584.0000
  Final e = -1584.0000
  E = p * π^T * T = 0.6 * π^T * T = [115.2000, 0.0000]
  w = e - E*x = -1584.0000 - E*[40.0, 80.0] = -6192.0000
================================================================================

Combined Results (Iteration 2):
================================================================================
Total objective value: -10032.0000
Total e: -1584.0000
Total E: [211.2000, 0.0000]
Total w: -10032.0000
================================================================================

GAP NOT CLOSED: w - θ = 8267.200000
Adding cut: 211.2000*x1 + θ ≥ -1584.0000
--------------------------------------------------------------------------------

ITERATION 3
--------------------------------------------------------------------------------
Step 1: Solving master problem

Master Problem Formulation (Iteration 3):
================================================================================
Minimize  100*x1 + 150*x2 + θ

Subject to:
  1*x1 + 1*x2 ≤ 120
  x1 ≥ 40
  x2 ≥ 20

Optimality cuts:
  83.5200*x1 + 180.4800*x2 + θ ≥ -520.0000
  211.2000*x1 + θ ≥ -1584.0000
================================================================================
Master problem solution:
  x = [66.827622, 53.172378]
  θ = -15697.993769
  Master objective = -1039.374870

Step 3: Solving subproblems

Subproblem Formulation (Scenario 1, Probability = 0.4):
================================================================================
h vector:
  h = [0, 0, 500, 100]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -24*y1 + -28*y2

Subject to:
  6*y1 + 10*y2 ≤ 4009.6573  (= 0 - -60*66.8276220145379 - 0*53.1723779854621)
  8*y1 + 5*y2 ≤ 4253.7902  (= 0 - 0*66.8276220145379 - -80*53.1723779854621)
  0 ≤ y1 ≤ 500
  0 ≤ y2 ≤ 100

Solution:
  y1 = 469.2238
  y2 = 100.0000
  Objective value = -14061.3707

Dual values (π vector):
  π = [0.0, -3.0, 0, -13.0]

Cut component calculations:
  e = p * π^T * h = 0.4 * ((0.0) * (0) + (-3.0) * (0) + (0) * (500) + (-13.0) * (100)) = 0.4 * -1300.0000 = -520.0000
  Final e = -520.0000
  E = p * π^T * T = 0.4 * π^T * T = [0.0000, 96.0000]
  w = e - E*x = -520.0000 - E*[66.8276220145379, 53.1723779854621] = -5624.5483
================================================================================

Subproblem Formulation (Scenario 2, Probability = 0.6):
================================================================================
h vector:
  h = [0, 0, 300, 300]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -28*y1 + -32*y2

Subject to:
  6*y1 + 10*y2 ≤ 4009.6573  (= 0 - -60*66.8276220145379 - 0*53.1723779854621)
  8*y1 + 5*y2 ≤ 4253.7902  (= 0 - 0*66.8276220145379 - -80*53.1723779854621)
  0 ≤ y1 ≤ 300
  0 ≤ y2 ≤ 300

Solution:
  y1 = 300.0000
  y2 = 220.9657
  Objective value = -15470.9034

Dual values (π vector):
  π = [-3.2, 0.0, -8.8, 0]

Cut component calculations:
  e = p * π^T * h = 0.6 * ((-3.2) * (0) + (0.0) * (0) + (-8.8) * (300) + (0) * (300)) = 0.6 * -2640.0000 = -1584.0000
  Final e = -1584.0000
  E = p * π^T * T = 0.6 * π^T * T = [115.2000, 0.0000]
  w = e - E*x = -1584.0000 - E*[66.8276220145379, 53.1723779854621] = -9282.5421
================================================================================

Combined Results (Iteration 3):
================================================================================
Total objective value: -14907.0903
Total e: -2104.0000
Total E: [115.2000, 96.0000]
Total w: -14907.0903
================================================================================

GAP NOT CLOSED: w - θ = 790.903427
Adding cut: 115.2000*x1 + 96.0000*x2 + θ ≥ -2104.0000
--------------------------------------------------------------------------------

ITERATION 4
--------------------------------------------------------------------------------
Step 1: Solving master problem

Master Problem Formulation (Iteration 4):
================================================================================
Minimize  100*x1 + 150*x2 + θ

Subject to:
  1*x1 + 1*x2 ≤ 120
  x1 ≥ 40
  x2 ≥ 20

Optimality cuts:
  83.5200*x1 + 180.4800*x2 + θ ≥ -520.0000
  211.2000*x1 + θ ≥ -1584.0000
  115.2000*x1 + 96.0000*x2 + θ ≥ -2104.0000
================================================================================
Master problem solution:
  x = [40.000000, 33.750000]
  θ = -9952.000000
  Master objective = -889.500000

Step 3: Solving subproblems

Subproblem Formulation (Scenario 1, Probability = 0.4):
================================================================================
h vector:
  h = [0, 0, 500, 100]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -24*y1 + -28*y2

Subject to:
  6*y1 + 10*y2 ≤ 2400.0000  (= 0 - -60*40.0 - 0*33.75)
  8*y1 + 5*y2 ≤ 2700.0000  (= 0 - 0*40.0 - -80*33.75)
  0 ≤ y1 ≤ 500
  0 ≤ y2 ≤ 100

Solution:
  y1 = 300.0000
  y2 = 60.0000
  Objective value = -8880.0000

Dual values (π vector):
  π = [-2.08, -1.44, 0, 0]

Cut component calculations:
  e = p * π^T * h = 0.4 * ((-2.08) * (0) + (-1.44) * (0) + (0) * (500) + (0) * (100)) = 0.4 * 0.0000 = 0.0000
  Final e = 0.0000
  E = p * π^T * T = 0.4 * π^T * T = [49.9200, 46.0800]
  w = e - E*x = 0.0000 - E*[40.0, 33.75] = -3552.0000
================================================================================

Subproblem Formulation (Scenario 2, Probability = 0.6):
================================================================================
h vector:
  h = [0, 0, 300, 300]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -28*y1 + -32*y2

Subject to:
  6*y1 + 10*y2 ≤ 2400.0000  (= 0 - -60*40.0 - 0*33.75)
  8*y1 + 5*y2 ≤ 2700.0000  (= 0 - 0*40.0 - -80*33.75)
  0 ≤ y1 ≤ 300
  0 ≤ y2 ≤ 300

Solution:
  y1 = 300.0000
  y2 = 60.0000
  Objective value = -10320.0000

Dual values (π vector):
  π = [-3.2, 0.0, -8.8, 0]

Cut component calculations:
  e = p * π^T * h = 0.6 * ((-3.2) * (0) + (0.0) * (0) + (-8.8) * (300) + (0) * (300)) = 0.6 * -2640.0000 = -1584.0000
  Final e = -1584.0000
  E = p * π^T * T = 0.6 * π^T * T = [115.2000, 0.0000]
  w = e - E*x = -1584.0000 - E*[40.0, 33.75] = -6192.0000
================================================================================

Combined Results (Iteration 4):
================================================================================
Total objective value: -9744.0000
Total e: -1584.0000
Total E: [165.1200, 46.0800]
Total w: -9744.0000
================================================================================

GAP NOT CLOSED: w - θ = 208.000000
Adding cut: 165.1200*x1 + 46.0800*x2 + θ ≥ -1584.0000
--------------------------------------------------------------------------------

ITERATION 5
--------------------------------------------------------------------------------
Step 1: Solving master problem

Master Problem Formulation (Iteration 5):
================================================================================
Minimize  100*x1 + 150*x2 + θ

Subject to:
  1*x1 + 1*x2 ≤ 120
  x1 ≥ 40
  x2 ≥ 20

Optimality cuts:
  83.5200*x1 + 180.4800*x2 + θ ≥ -520.0000
  211.2000*x1 + θ ≥ -1584.0000
  115.2000*x1 + 96.0000*x2 + θ ≥ -2104.0000
  165.1200*x1 + 46.0800*x2 + θ ≥ -1584.0000
================================================================================
Master problem solution:
  x = [46.666667, 36.250000]
  θ = -10960.000000
  Master objective = -855.833333

Step 3: Solving subproblems

Subproblem Formulation (Scenario 1, Probability = 0.4):
================================================================================
h vector:
  h = [0, 0, 500, 100]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -24*y1 + -28*y2

Subject to:
  6*y1 + 10*y2 ≤ 2800.0000  (= 0 - -60*46.6666666666666 - 0*36.25)
  8*y1 + 5*y2 ≤ 2900.0000  (= 0 - 0*46.6666666666666 - -80*36.25)
  0 ≤ y1 ≤ 500
  0 ≤ y2 ≤ 100

Solution:
  y1 = 300.0000
  y2 = 100.0000
  Objective value = -10000.0000

Dual values (π vector):
  π = [0.0, -3.0, 0, -13.0]

Cut component calculations:
  e = p * π^T * h = 0.4 * ((0.0) * (0) + (-3.0) * (0) + (0) * (500) + (-13.0) * (100)) = 0.4 * -1300.0000 = -520.0000
  Final e = -520.0000
  E = p * π^T * T = 0.4 * π^T * T = [0.0000, 96.0000]
  w = e - E*x = -520.0000 - E*[46.6666666666666, 36.25] = -4000.0000
================================================================================

Subproblem Formulation (Scenario 2, Probability = 0.6):
================================================================================
h vector:
  h = [0, 0, 300, 300]

T matrix:
  T[0] = [-60, 0]
  T[1] = [0, -80]
  T[2] = [0, 0]
  T[3] = [0, 0]

Minimize  -28*y1 + -32*y2

Subject to:
  6*y1 + 10*y2 ≤ 2800.0000  (= 0 - -60*46.6666666666666 - 0*36.25)
  8*y1 + 5*y2 ≤ 2900.0000  (= 0 - 0*46.6666666666666 - -80*36.25)
  0 ≤ y1 ≤ 300
  0 ≤ y2 ≤ 300

Solution:
  y1 = 300.0000
  y2 = 100.0000
  Objective value = -11600.0000

Dual values (π vector):
  π = [-3.2, 0.0, -8.8, 0]

Cut component calculations:
  e = p * π^T * h = 0.6 * ((-3.2) * (0) + (0.0) * (0) + (-8.8) * (300) + (0) * (300)) = 0.6 * -2640.0000 = -1584.0000
  Final e = -1584.0000
  E = p * π^T * T = 0.6 * π^T * T = [115.2000, 0.0000]
  w = e - E*x = -1584.0000 - E*[46.6666666666666, 36.25] = -6960.0000
================================================================================

Combined Results (Iteration 5):
================================================================================
Total objective value: -10960.0000
Total e: -2104.0000
Total E: [115.2000, 96.0000]
Total w: -10960.0000
================================================================================

Duplicate cut detected - stopping algorithm

================================================================================
L-SHAPED METHOD SUMMARY
================================================================================
Successfully converged in 5 iterations.

Final solution:
  x = [46.666667, 36.250000]
  First-stage cost = 10104.166667
  Expected second-stage cost = -10960.000000
  Total objective = -855.833333

Convergence history:
----------------------------------------------------------------------------------------------------
Iter  |       x1        |       x2        |      theta      |        w        |       gap      
----------------------------------------------------------------------------------------------------
  1   |    40.000000    |    20.000000    |      -inf       |  -7470.400000   |       inf      
  2   |    40.000000    |    80.000000    |  -18299.200000  |  -10032.000000  |   8267.200000  
  3   |    66.827622    |    53.172378    |  -15697.993769  |  -14907.090343  |   790.903427   
  4   |    40.000000    |    33.750000    |  -9952.000000   |  -9744.000000   |   208.000000   
  5   |    46.666667    |    36.250000    |  -10960.000000  |  -10960.000000  |    0.000000    

FINAL SOLUTION SUMMARY:
================================================================================
x = [46.666667, 36.250000]
Objective value = -855.833333
Number of iterations = 5
Convergence status = Converged
(.venv) .venvrjcomputer@Mac Stoch HW3 % 